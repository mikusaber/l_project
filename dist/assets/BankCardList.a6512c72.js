import{_ as B}from"./add.830e9852.js";import{_ as x,r as I,a as L,U as b,o as c,c as i,i as s,F as P,g as S,u as d,b as p,d as m,p as G,j as q,e as T,T as z,f as u,t as l,q as h}from"./index.7dbf11ab.js";import{T as n}from"./index.02745042.js";import{G as N,a as V,B as D}from"./card.ebbaceea.js";import"./moment.17f8281e.js";/* empty css                                                          */import"./request.869d566e.js";const F=o=>(G("data-v-65210a01"),o=o(),q(),o),R={class:"Bank-Card-List"},j={class:"list"},A={class:"top"},E={class:"bottom"},M={class:"price"},U=F(()=>s("div",{class:"icon"},[s("img",{src:B,alt:""})],-1)),H=h("\u68C0\u67E5\u7ED1\u5361\u72B6\u6001\uFF1A"),J={style:{"font-size":"22px"}},K=h("\u79D2"),O={setup(o){T();const r=z(),t=I({list:[],timer:null,show:!1,second:5});L(()=>{f()});const f=async()=>{try{const a=await N({action:"GetPayBankCardList",paymentCompanyId:1});if(a.code!=0)return n(a.message),!1;t.list=a.data,console.log(a),y()}catch(e){console.log(e)}},y=async()=>{console.log(r.query),r.query.out_trade_no&&(t.show=!0,t.timer=window.setInterval(()=>{t.second--,t.second?v():(t.show=!1,n("\u672A\u67E5\u8BE2\u5230\u7ED3\u679C\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"),clearInterval(t.timer))},1e3))},v=async()=>{try{let e={action:"GetPayBankCardInfo",paymentCompanyId:1,id:r.query.out_trade_no};const a=await V(e);if(a.code!=0)return n(a.message),clearInterval(t.timer),!1;if(a.data.CardStatus==1){t.show=!1,clearInterval(t.timer),b.alert({title:"\u6C47\u4ED8\u5B9D",message:"\u94F6\u884C\u5361\u7ED1\u5B9A\u6210\u529F"}).then(()=>{});return}console.log(a)}catch(e){console.log(e)}},g=async()=>{try{const a=await D({action:"BindPayBankCard",paymentCompanyId:1});if(a.code!=0)return n(a.message),!1;console.log(a),window.location.href=a.data.sign_url}catch(e){console.log(e)}};return(e,a)=>{const k=u("van-loading"),w=u("van-popup");return c(),i("div",R,[s("div",j,[(c(!0),i(P,null,S(d(t).list,(_,C)=>(c(),i("div",{class:"item",key:C},[s("div",A,l(_.bank_name),1),s("div",E,[s("div",M,l(_.bank_card_no),1)])]))),128))]),s("div",{class:"add-card"},[U,s("div",{class:"text",onClick:g},"\u6DFB\u52A0\u94F6\u884C\u5361")]),p(w,{style:{width:"200px",height:"120px","font-size":"18px","text-align":"center","line-height":"120px","border-radius":"5px",overflow:"hidden"},show:d(t).show},{default:m(()=>[p(k,{size:"24px"},{default:m(()=>[H,s("b",J,l(d(t).second),1),K]),_:1})]),_:1},8,["show"])])}}};var ta=x(O,[["__scopeId","data-v-65210a01"]]);export{ta as default};
